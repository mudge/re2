<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: RE2::Set
  
    &mdash; RE2: Ruby bindings to re2
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "RE2::Set";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../RE2.html" title="RE2 (module)">RE2</a></span></span>
     &raquo; 
    <span class="title">Set</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: RE2::Set
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">RE2::Set</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>ext/re2/re2.cc</dd>
  </dl>
  
</div>








  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#match_raises_errors%3F-class_method" title="match_raises_errors? (class method)">.<strong>match_raises_errors?</strong>  &#x21d2; Bool </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns whether the underlying re2 version outputs error information from RE2::Set::Match.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add-instance_method" title="#add (instance method)">#<strong>add</strong>(pattern)  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Adds a pattern to the set.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#compile-instance_method" title="#compile (instance method)">#<strong>compile</strong>  &#x21d2; Bool </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Compiles a Set so it can be used to match against.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(*args)  &#x21d2; RE2::Set </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a new <span class='object_link'><a href="" title="RE2::Set (class)">Set</a></span> object, a collection of patterns that can be searched for simultaneously.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#match-instance_method" title="#match (instance method)">#<strong>match</strong>(*args)  &#x21d2; Array&lt;Integer&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Matches the given text against patterns in the set, returning an array of integer indices of the matching patterns if matched or an empty array if there are no matches.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    
      <span class="overload">#<strong>initialize</strong>  &#x21d2; <tt><span class='object_link'><a href="" title="RE2::Set (class)">RE2::Set</a></span></tt> </span>
    
      <span class="overload">#<strong>initialize</strong>(anchor)  &#x21d2; <tt><span class='object_link'><a href="" title="RE2::Set (class)">RE2::Set</a></span></tt> </span>
    
      <span class="overload">#<strong>initialize</strong>(anchor, options)  &#x21d2; <tt><span class='object_link'><a href="" title="RE2::Set (class)">RE2::Set</a></span></tt> </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new <span class='object_link'><a href="" title="RE2::Set (class)">RE2::Set</a></span> object, a collection of patterns that can be searched for simultaneously.</p>


  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">#<strong>initialize</strong>  &#x21d2; <tt><span class='object_link'><a href="" title="RE2::Set (class)">RE2::Set</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Returns a new <span class='object_link'><a href="" title="RE2::Set (class)">RE2::Set</a></span> object for unanchored patterns with the default options.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>NoMemoryError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if memory could not be allocated for the compiled pattern</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">#<strong>initialize</strong>(anchor)  &#x21d2; <tt><span class='object_link'><a href="" title="RE2::Set (class)">RE2::Set</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Returns a new <span class='object_link'><a href="" title="RE2::Set (class)">RE2::Set</a></span> object for the specified anchor with the default options.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>anchor</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>One of :unanchored, :anchor_start, :anchor_both</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if anchor is not :unanchored, :anchor_start or :anchor_both</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>NoMemoryError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if memory could not be allocated for the compiled pattern</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">#<strong>initialize</strong>(anchor, options)  &#x21d2; <tt><span class='object_link'><a href="" title="RE2::Set (class)">RE2::Set</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Returns a new <span class='object_link'><a href="" title="RE2::Set (class)">RE2::Set</a></span> object with the specified options.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>anchor</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>One of :unanchored, :anchor_start, :anchor_both</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the options with which to compile the pattern</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:utf8</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>text and pattern are UTF-8; otherwise Latin-1</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:posix_syntax</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>restrict regexps to POSIX egrep syntax</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:longest_match</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>search for longest match, not first match</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:log_errors</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>log syntax and execution errors to ERROR</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:max_mem</span>
          <span class="type">(<tt>Fixnum</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>approx. max memory footprint of RE2</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:literal</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>interpret string as literal, not regexp</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:never_nl</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>never match n, even if it is in regexp</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:case_sensitive</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>match is case-sensitive (regexp can override with (?i) unless in posix_syntax mode)</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:perl_classes</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>allow Perl’s d s w D S W when in posix_syntax mode</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:word_boundary</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>allow b B (word boundary and not) when in posix_syntax mode</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:one_line</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>^ and $ only match beginning and end of text when in posix_syntax mode</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if anchor is not one of the accepted choices</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>NoMemoryError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if memory could not be allocated for the compiled pattern</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
  </ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1430
1431
1432
1433
1434
1435
1436
1437
1438
1439
1440
1441
1442
1443
1444
1445
1446
1447
1448
1449
1450
1451
1452
1453
1454
1455
1456
1457
1458
1459
1460
1461
1462
1463
1464</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/re2/re2.cc', line 1430</span>

static VALUE re2_set_initialize(int argc, VALUE *argv, VALUE self) {
  VALUE anchor, options;
  re2_set *s;
  RE2::Anchor re2_anchor;
  RE2::Options re2_options;

  rb_scan_args(argc, argv, &quot;02&quot;, &amp;anchor, &amp;options);
  Data_Get_Struct(self, re2_set, s);

  if (RTEST(options)) {
    parse_re2_options(re2_options, options);
  }
  if (NIL_P(anchor)) {
    re2_anchor = RE2::UNANCHORED;
  } else {
    Check_Type(anchor, T_SYMBOL);
    ID id_anchor = SYM2ID(anchor);
    if (id_anchor == id_unanchored) {
      re2_anchor = RE2::UNANCHORED;
    } else if (id_anchor == id_anchor_start) {
      re2_anchor = RE2::ANCHOR_START;
    } else if (id_anchor == id_anchor_both) {
      re2_anchor = RE2::ANCHOR_BOTH;
    } else {
      rb_raise(rb_eArgError, &quot;anchor should be one of: :unanchored, :anchor_start, :anchor_both&quot;);
    }
  }

  s-&gt;set = new(nothrow) RE2::Set(re2_options, re2_anchor);
  if (s-&gt;set == 0) {
    rb_raise(rb_eNoMemError, &quot;not enough memory to allocate RE2::Set object&quot;);
  }

  return self;
}</pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="match_raises_errors?-class_method">
  
    .<strong>match_raises_errors?</strong>  &#x21d2; <tt>Bool</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns whether the underlying re2 version outputs error information from RE2::Set::Match. If not, #match will raise an error if attempting to set its :exception option to true.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>whether the underlying re2 outputs error information from Set matches</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1516
1517
1518
1519
1520
1521
1522</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/re2/re2.cc', line 1516</span>

<span class='id identifier rubyid_static'>static</span> <span class='const'>VALUE</span> <span class='id identifier rubyid_re2_set_match_raises_errors_p'>re2_set_match_raises_errors_p</span><span class='lparen'>(</span><span class='const'>VALUE</span> <span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span>
<span class='comment'>#ifdef HAVE_ERROR_INFO_ARGUMENT
</span>  <span class='kw'>return</span> <span class='const'>Qtrue</span><span class='semicolon'>;</span>
<span class='comment'>#else
</span>  <span class='kw'>return</span> <span class='const'>Qfalse</span><span class='semicolon'>;</span>
<span class='comment'>#endif
</span><span class='rbrace'>}</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add-instance_method">
  
    #<strong>add</strong>(pattern)  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Adds a pattern to the set. Returns the index that will identify the pattern in the output of #match. Cannot be called after #compile has been called.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_set'>set</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../RE2.html" title="RE2 (module)">RE2</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="RE2::Set (class)">Set</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="RE2::Set#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_set'>set</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>    <span class='comment'>#=&gt; 0
</span><span class='id identifier rubyid_set'>set</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>def</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>    <span class='comment'>#=&gt; 1</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>pattern</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="String.html" title="RE2::String (module)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the regex pattern</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the index of the pattern in the set</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if called after compile or the pattern is rejected</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1478
1479
1480
1481
1482
1483
1484
1485
1486
1487
1488
1489
1490</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/re2/re2.cc', line 1478</span>

static VALUE re2_set_add(VALUE self, VALUE pattern) {
  Check_Type(pattern, T_STRING);
  re2::StringPiece regex(RSTRING_PTR(pattern), RSTRING_LEN(pattern));
  std::string err;
  re2_set *s;
  Data_Get_Struct(self, re2_set, s);
  int index = s-&gt;set-&gt;Add(regex, &amp;err);
  if (index &lt; 0) {
    rb_raise(rb_eArgError, &quot;str rejected by RE2::Set-&gt;Add(): %s&quot;, err.c_str());
  }

  return INT2FIX(index);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="compile-instance_method">
  
    #<strong>compile</strong>  &#x21d2; <tt>Bool</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Compiles a Set so it can be used to match against. Must be called after #add and before #match.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_set'>set</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../RE2.html" title="RE2 (module)">RE2</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="RE2::Set (class)">Set</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="RE2::Set#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_set'>set</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_set'>set</span><span class='period'>.</span><span class='id identifier rubyid_compile'>compile</span>    <span class='comment'># =&gt; true</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>whether compilation was a success</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1502
1503
1504
1505
1506
1507</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/re2/re2.cc', line 1502</span>

static VALUE re2_set_compile(VALUE self) {
  re2_set *s;
  Data_Get_Struct(self, re2_set, s);

  return BOOL2RUBY(s-&gt;set-&gt;Compile());
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="match-instance_method">
  
    
      <span class="overload">#<strong>match</strong>(str)  &#x21d2; <tt>Array&lt;Integer&gt;</tt> </span>
    
      <span class="overload">#<strong>match</strong>(str, options)  &#x21d2; <tt>Array&lt;Integer&gt;</tt> </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Matches the given text against patterns in the set, returning an array of integer indices of the matching patterns if matched or an empty array if there are no matches.</p>


  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">#<strong>match</strong>(str)  &#x21d2; <tt>Array&lt;Integer&gt;</tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Returns an array of integer indices of patterns matching the given string (if any). Raises exceptions if there are any errors while matching.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_set'>set</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../RE2.html" title="RE2 (module)">RE2</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="RE2::Set (class)">Set</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="RE2::Set#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_set'>set</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_set'>set</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>def</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_set'>set</span><span class='period'>.</span><span class='id identifier rubyid_compile'>compile</span>
<span class='id identifier rubyid_set'>set</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>abcdef</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>    <span class='comment'># =&gt; [0, 1]</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>str</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="String.html" title="RE2::String (module)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the text to match against</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;Integer&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the indices of matching regexps</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>MatchError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if an error occurs while matching</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>UnsupportedError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if the underlying version of re2 does not output error information</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">#<strong>match</strong>(str, options)  &#x21d2; <tt>Array&lt;Integer&gt;</tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Returns an array of integer indices of patterns matching the given string (if any). Raises exceptions if there are any errors while matching and the :exception option is set to true.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_set'>set</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../RE2.html" title="RE2 (module)">RE2</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="RE2::Set (class)">Set</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="RE2::Set#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_set'>set</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_set'>set</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>def</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_set'>set</span><span class='period'>.</span><span class='id identifier rubyid_compile'>compile</span>
<span class='id identifier rubyid_set'>set</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>abcdef</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:exception</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='rparen'>)</span>    <span class='comment'># =&gt; [0, 1]</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>str</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="String.html" title="RE2::String (module)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the text to match against</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the options with which to match</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:exception</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>whether to raise exceptions with re2’s error information (not supported on ABI version 0 of re2)</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;Integer&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the indices of matching regexps</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>MatchError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if an error occurs while matching</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>UnsupportedError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if the underlying version of re2 does not output error information</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
  </ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;Integer&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1564
1565
1566
1567
1568
1569
1570
1571
1572
1573
1574
1575
1576
1577
1578
1579
1580
1581
1582
1583
1584
1585
1586
1587
1588
1589
1590
1591
1592
1593
1594
1595
1596
1597
1598
1599
1600
1601
1602
1603
1604
1605
1606
1607
1608
1609
1610
1611
1612
1613
1614
1615
1616
1617
1618
1619
1620
1621
1622
1623
1624</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/re2/re2.cc', line 1564</span>

static VALUE re2_set_match(int argc, VALUE *argv, VALUE self) {
  VALUE str, options, exception_option;
  bool raise_exception = true;
  rb_scan_args(argc, argv, &quot;11&quot;, &amp;str, &amp;options);
  Check_Type(str, T_STRING);
  re2::StringPiece data(RSTRING_PTR(str), RSTRING_LEN(str));
  std::vector&lt;int&gt; v;
  re2_set *s;
  Data_Get_Struct(self, re2_set, s);

  if (RTEST(options)) {
    Check_Type(options, T_HASH);

    exception_option = rb_hash_aref(options, ID2SYM(id_exception));
    if (!NIL_P(exception_option)) {
      raise_exception = RTEST(exception_option);
    }
  }

  if (raise_exception) {
#ifdef HAVE_ERROR_INFO_ARGUMENT
    RE2::Set::ErrorInfo e;
    bool match_failed = !s-&gt;set-&gt;Match(data, &amp;v, &amp;e);
    VALUE result = rb_ary_new2(v.size());

    if (match_failed) {
      switch (e.kind) {
        case RE2::Set::kNoError:
          break;
        case RE2::Set::kNotCompiled:
          rb_raise(re2_eSetMatchError, &quot;#match must not be called before #compile&quot;);
        case RE2::Set::kOutOfMemory:
          rb_raise(re2_eSetMatchError, &quot;The DFA ran out of memory&quot;);
        case RE2::Set::kInconsistent:
          rb_raise(re2_eSetMatchError, &quot;RE2::Prog internal error&quot;);
        default:  // Just in case a future version of libre2 adds new ErrorKinds
          rb_raise(re2_eSetMatchError, &quot;Unknown RE2::Set::ErrorKind: %d&quot;, e.kind);
      }
    } else {
      for (size_t i = 0; i &lt; v.size(); i++) {
        rb_ary_push(result, INT2FIX(v[i]));
      }
    }

    return result;
#else
    rb_raise(re2_eSetUnsupportedError, &quot;current version of RE2::Set::Match() does not output error information, :exception option can only be set to false&quot;);
#endif
  } else {
    bool matched = s-&gt;set-&gt;Match(data, &amp;v);
    VALUE result = rb_ary_new2(v.size());

    if (matched) {
      for (size_t i = 0; i &lt; v.size(); i++) {
        rb_ary_push(result, INT2FIX(v[i]));
      }
    }

    return result;
  }
}</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Oct 17 11:07:43 2022 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.28 (ruby-3.1.2).
</div>

    </div>
  </body>
</html>